setwd("C:/Users/rache/OneDrive/Desktop/GRA/Pipelines/MB_Decontamination")
library(tidyverse)
# data
blocklist = read.csv("contaminant-blocklist.csv", header = F)
gen = read.csv("Level6_Genus.csv", header=T,row.name=1)
batch = gen$Batch
group = gen$Groups
age = gen$Age
race = gen$Race
gen = gen[,1:(ncol(gen)-5)] # remove non-count cols
index = grep(".*.g__*", colnames(gen)) # keep if have IDed genus
gen = gen[,index]
comp = data.frame(colnames(gen))
comp$compare = sub(".*.g__", "", colnames(gen)) # subset to only genus
index2 = which(comp$compare=="")
comp = comp[-index2,]
index = grep(".*.g__*", colnames(gen)) # keep if have IDed genus
gen = gen[,index]
colnames(gen) = sub(".*.g__", "", colnames(gen)) # subset to only genus
index2 = which(names(gen)=="")
gen = gen[,-index2] # remove if no value
dat = gen
control = group
control = control == "Negative Control"
sample = group
sample[!sample == "Control"] = "Plasma"
dat = as.matrix(dat)
meta = data.frame("is_control" = control,
"sample" = sample)
rownames(meta) = rownames(dat)
scr_out = SCRuB(dat,
metadata = meta)
########################### SCRuB ###############################################
# devtools::install_github("shenhav-and-korem-labs/SCRuB")
library(SCRuB)
scr_out = SCRuB(dat,
metadata = meta)
setwd("C:/Users/rache/OneDrive/Desktop/GRA/Pipelines/MB_Decontamination/SCRuB Method Illustration")
set.seed(1)
library(tidyverse)
library(SCRuB)
data <- read.csv('plasma_data.csv', row.names=1) %>% as.matrix()
dim(data)
metadata <- read.csv('plasma_metadata.csv', row.names=1)
metadata %>% head()
scr_out <- SCRuB(data, metadata, c("control blank DNA extraction", "control blank library prep") )
metadata <- read.csv('plasma_metadata.csv', row.names=1)
metadata %>% head()
scr_out <- SCRuB(data, metadata, c("control blank DNA extraction", "control blank library prep") )
data <- read.csv('plasma_data.csv', row.names=1) %>% as.matrix()
dim(data)
metadata <- read.csv('plasma_metadata.csv', row.names=1)
metadata %>% head()
scr_out <- SCRuB(data, metadata, c("control blank DNA extraction", "control blank library prep") )
